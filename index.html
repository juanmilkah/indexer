<html>
  <head>
    <title>Indexer</title>
    <meta charset="utf-8" />

    <style>
      #query {
        width: 500px;
        height: 50px;
      }
    </style>
  </head>
  <body>
    <h1>Type a query to search</h1>
    <input type="text" placeholder="query..." value="" id="query" autofocus />
    <ul id="results"></ul>

    <script>
      let input = document.getElementById("query");
      const results = document.getElementById("results");

      input.value.addEventListener("change", () => {
        let query = input.value;
        if (query.length !== 0) {
          fetch("/search", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ query: query }),
          })
            .then((response) => response.text())
            .then((result) => {
              // result is a string of strings separated by newline
              const list_items = result.split("\n");

              // Clear previous results
              results.innerHTML = "";

              list_items.forEach((item) => {
                if (item.trim() !== "") {
                  const li = document.createElement("li");
                  li.textContent = item;
                  results.appendChild(li);
                }
              });
            })
            .catch((err) => console.error(err));
        }
      });
    </script>
  </body>
</html>
